

#### 표본추출 방법
* 단순랜덤추출법
* 계통추출법
* 층화추출법


##
* A,B가 독립이면 각 조건부확률은 독립확률과 같음
* 통계적 추론은 본질적으로 불확실성을 수반한다
* 

# 5장 정형 데이터 마이닝

* 통계분석은 가설이나 가정에 따른 분석이나 검증을 하지만 데이마이닝은 다양한 수리 알고리즘을 이용해 의미있는 정보를 찾아내는 방법을 통칭
* 종류
	* 정보를 찾는 종류
		* 인공지능
		* 의사결정나무
		* k 평균군집화
		* 연관분석
		* 회귀분석
		* 로짓분석
		* 최근접이웃(nearest neighborhood)
	* 분석대상, 활용목적, 표현방법에 따른 종류
		* 시각화분석
		* 분류
		* 군집화
		* 포케스팅

* 연관규칙 : 데이터 안에 존재하는 항목간의 종속관계 찾음
	* 교차판매, 매장진열, 첨부우편, 사기적발
* 연속규칙 : 연관규칙 + 시간정보으로 고객의 구매이력이 필요
	* 목표마케팅, 일대일 마케팅

#### 데이터마이닝 추진단계
1. 목적설정
	- 전문가가 참여해 목적에 따라 사용할 모델과 필요 데이터 정의
2. 데이터 준비
3. 가공
	- 모델링 목적에 따라 목적 변수 적의
4. 기법적용
5. 검증

#### 데이터 분할
1. 구축용(training data)
2. 검정용(validation data)
3. 시험용(test data)

데이터의 양이 충분하지 않거나 입력 변수에 설명이 부족하면
1. 홀드아웃 방법 : 주어진 데이터를 랜덤하게 두 개의 데이터로 구분하여 사용, 학습용과 시험용을 분리하여 사용
2. 교차확인(cross-validation) 방법 : 주어진 데이터를 k개의 하부집단으로 구분하여, k-1개 집단을 학습용 나머지는 검증용으로 사용
 k번 반복 측정한 결과를 평균낸 값을 최종값으로 사용

#### 성과분석
* True Positive : Positive -> Positive 로 예측
* False Negative : Positive -> Negative 로 예측
* False Postive : Negative -> Positive 
* True Negative : Negative -> Negative

1. 정분류율(Accuracy) : TN+TP / 전체
2. 오분류율(Error Rate) : FN+FP / 전체
3. 특이도(Specificity) : TN / TN+FP (전체 Negative 중 똑바로 예측한거)
4. 민감도(Specificity) : TP / TP+FP (전체 Positive 중 똑바로 예측한거)
5. 정확도(Precision) : TP / TP+FP ( Positive로 예측한 것 중 정탐)
6. 재현율(Recall) == 민감도
7. F1 Score : 2*(Precision*Recall)/(Precision+Recall)

**ROCR 패키지로 성과분석**
* ROC Curve(Receiver Operating Characteristic Curve)
	* 가로축 : FPR(false positive rate = 1-특이도, 0을 1로 잘못 예측한 값)
	   세로축 : TPR(민감도,1을 1로 잘 예측한 값)
	* **2진 분류** 성능 평가
	* 왼쪽 상단에 가까울 수록 좋음
	* 면적은 AUROC(Area Under ROC) 값이 클수록 좋음
		* AR = 2*면적 - 100%
```R
pred <- prediction(x.evaluate$probabilities, x.evaluate$Kyphosis)
perf <- performance(pred, “tpr”, “fpr”)
plot(perf, main=“ROC curve”, colorize=T)
```

**이익도표(Lift chart)**
* 분류모형의 성능을 평가하기 위한 척도
* 얼마나 잘 예측됐는지 확인하려고 임의로 나눈 각 등급별로 반응검출율, 반응률, 리프트 등의 정보를 산출하여 나타내는 도표
* 기본 향상도에 비해 반응률이 몇 배나 높은지 계산 -> 향상도(Lift)
* 각 등급은 예측확률에 따라 매겨진 순위, 상위 등급에서는 더 높은 방응률을 보이는것이 좋은 모형
* 등급별로 향상도가 급격하게 변동할수록 좋은 모형

## 분류분석
### 분류분석과 예측분석
**분류분석**
* 클러스터링과 유사하지만, 분류분석은 각 그룹이 정의되어 있음
* 지도학습
* 예) 점수를 통해 내신등급 맞추기, 신용등급 맞추기
* 모델링
	* 신용평가모델, 사기방지모형, 이탈모형, 고객세분화
* 분류기법
	* 회귀분석, 의사결정나무, CART, C5.0, 베이지안 분류, 인공신경망, 지도백터기계(SVM), KNN, 규칙기반의 분류와 사례기반 추론

**예측분석**
* 시계열처럼 시간에 따른 값 두 개만을 이용해 예측
* 한 개의 설명변수
* 예) 수능점수 맞추기, 연 매출 맞추기

**공통점**
* 레코드의 특정 속성의 값을 미리 알아맞히는 점

**차이점**
* 분류 -> 범주형 속성
* 예측 -> 연속형 속성

### 로지스틱 회귀분석
* 반응변수가 범주형
* 각 범주에 속할 확률치 추정
* 모형의 적합을 통해 추정된 확률 -> 사후확률
* exp(B1)의 의미는 나머지 변수(x)가 주어질 때, x1이 한 단위 증가할 때마다 성공(Y=1)의 오즈가 몇 배 증가하는지 나타내는 값
* 오즈비 : 오즈는 성공할 확률이 실패할 확률의 몇 배인지 나타내는 확률이며, 오즈비는 오즈의 비율(성공/실패할 확률)
	* ex) 오즈비가 36이면, 실패할 확률이 성공할 확률의 36배
* 최대우도 추정법(MLE : Maximum Likelihood Estimation)
	* 모수가 미지의 세타인 확률분포에서 뽑은 표본 x들을 바탕으로 세타를 추정하는 기법
	* 우도(likelihood)는 이미 주어진 표본 x들에 비추어봤을 때 모집단의 모수 세타에 대한 추정이 그럴듯한 정도를 말한다
	* 우도는 세타가 전제되었을때 표본x가 등장할 확률인 p(x|세타)에 비례
* glm(종속변수 ~ 독립변수 ~~, familly=binomal, data=)
		
|목적|선형회귀분석  |로지스틱회귀분석|
|--|--|-|
| 종속변수 | 연속형 변수 |(0,1)|
|계수 추정법|최소제곱법|최대우도추정법|
|모형 검정| F,T 검정|카이제곱 검정|

### 의사결정나무
* 비정상 잡음 데이터에 대해 민감함없이 분류가능
* 대용량 데이터도 빠르게 만들 수 있음
* 한 변수와 상관성이 높은 다른 불필요한 변수가 있어도 크게 영향받지 않음
* 수치형, 범주형 모두 가능
* 모형 분류 정확도가 높음
* <단점> 새로운 자료에 대해 과대적합 발생가능성 높음 -> 가지치기필요
* 분류 경계선 부근의 자료값에 대해 오차가 큼
* 설명변수 간의 중요도를 판단하기 쉽지 않음

**분석과정**
1. 성장과정
	* 분리규칙 : 불순도 감소량을 가장 크게
	* 분리기준
		* 이산형 : 카이제곱 통계량 p값, 지니 지수, 엔트로피 지수
		* 연속형 : 분산분석에서 F통계량, 분산의 감소량
	* 정지기준
		* 나무 깊이, 끝마디의 레코드 수의 최소 개수 지정
2. 가지치기
	* 마디에 속하는 자료가 일정 수 이하일 때 분할 정지
	* 비용-복잡도 가지치기를 이용하여 성장시킨 나무를 가지칙ㅔ
3. 타당성 평가
	* 이익도표, 위험도표
4. 해석 및 예측

**불순도 측정 종류**
* 카이제곱 통계량
	* 각 셀에 대한 계산
	* ((실제도수-기대도수)^2/기대도수) 의 합
* 지니지수
	* 열에 대한 계산
	* 노드의 불순도를 나타내는 값
	* 값이 클수록 순수도가 낮음
	* 1-((확률)^2)의 합
	* 지니지수 계산 방법 : 2(P(Left에서 GOOD)P(Left에서 BAD)P(Left)+P(Right에서 GOOD)P(Right에서 BAD)P(Right))
* 엔트로피 지수
	* 열에 대한 계산
	* 무질서 정도
	* 값이 클수록 순수도 낮음
	* -(확률*log확률 의 합)
	* 엔트로피 계산 : 엔트로피(Left)p(Left)+엔트로피(Right)P(Right)

**알고리즘**
* CART(Classification and Regression Tree)
	* 가장 많이씀, 이진분리
	* 불순도의 측도로 출력변수가 범주형 -> 지니지수
	* 연속형 -> 이진분리
	* 입력변수들의 선형결합들 중에서 최적을 분리도 찾을 수 있음
* C4.5, C5.0
	* 다진분리
	* 엔트로피지수 사용
* CHAID(CHi-squared Automatic Interaction Detection)
	* 가지치기를 하지 않고 적당한 크기에서 성장 중지
	* 입력변수는 범주형만
	* 카이제곱 통계량

## 앙상블(Ensemble) 분석

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTAzNDU1ODE2NywxMjAwNjczMDMyLC0xOT
gzMzg3NDM5LDY0NTM4MDc0NCwtNDE3MjUyOTcwLDU2MDkyNjE2
MCwtMTIwMTkwODAyMywtMjA5NDA5NjMzNCwtMjAzMzU2Mzc3MC
wtMjA4ODc0NjYxMl19
-->